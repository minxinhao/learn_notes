# 日志结构合并树

为了阅读LSM Tree的论文原文而进行的工作。为了防止自己在读论文的时候睡着，选择边读边将论文翻译成
中文。

> 摘要：高性能的事务系统应用通常会在历史表中插入行来提供活动追踪；同时为了系统恢复，事务系统会生成一个记录文件。生成的这两种信息都能从高效索引中获得收益。一个广为人知的例子就是TPC-A测评应用，这些应用支持对特定账号活动记录的查询。这就需要在快速增长的历史表对账户号建立索引。不幸的是，标准的磁盘索引结构如B树会很快的增倍事务的开销来实时的维持索引，导致整体系统开销增加50%。显然急需一个低开销地维持实时索引的方法。日志结构合并树是一个基于磁盘的数据结构，被设计用来提供低成本的文件索引和在一段长时间内的高速率的记录插入（删除）。
> LSM树使用一个算法来延迟和批量化索引修改，以有效的方式将基于内存的组件的更改通过一个或者多个磁盘组件进行，这和合并排序有点像。在此过程中，所有索引值均可通过内存组件或者其中一个磁盘组件继续访问检索（除了非常短的锁定周期外）。跟传统的访问方法例（如B树）相比，这个算法极大的减少了磁盘臂的移动，将会提高使用传统访问方法插入领域的性价比。这些领域的插入中，磁盘臂成本超过了存储介质成本。LSM树的方法同样可以泛化到除了插入和删除的其他操作。然后，需要立刻响应的索引查找在某些情况下将会损失I/O效率，所以LSM树主要用在索引插入相对于查找是索引检索最主要操作的应用中。而这对于历史表、记录文件都是很皮鞭的性质。第6节的结论比较了LSM树访问方法中内存和磁盘组件的混合使用和混合方法在内存中缓存磁盘页的常见优势。

## 1.引言

随着活动流管理系统中的长期食物变得商业化，对事物日志记录的索引访问需求将越来越大。传统上，事务日志记录侧重于事务中止和恢复，要求系统在正常处理中引用相对较短的历史，偶尔回滚事务，同时使用批处理的顺序读取来完成恢复。但是，随着系统承担更复杂的活动，构成单个长期活动的事件持续时间和数量将增加到有时需要实时查看过去的事务步骤来提醒用户已经完成的任务。同时，一个系统知道的活动事务的数量将会增长到现在用于跟踪活动的内存主流的数据结构不再可行，而不是预期的内存开销持续下降。需要会回答有关大量过去活动日志的查询意味着索引日志访问将变得越来越重要。
即使使用当前的事务系统，提供索引来支持具有高插入量的历史表上的查询页具有很明显的价值。网络、电子邮件和其他和交易想近的系统经常产生巨大的日志而损坏了其主机系统。为了从一个具体的、广为人知的例子开始，我们在一下示例1.1和1.2中探讨了经过修改的TPC-A基准。注意为了方便演示，本文中介绍的示例涉及特定的数值参数值，泛化这些结果应该是很简单的任务。同时注意虽然历史表和日志都涉及时间序列数据，但是LSM树的索引条目并要求去油同样的时间顺序。和检索速率相比，提高效率的唯一实现时高更新率。

### 5分钟规则

接下来的两个例子都建立在5分钟规则的基础上。这个基本结果表明，通过购买内存缓存区空间来将页面保存在内存中。











